diff --git a/django/db/migrations/executor.py b/django/db/migrations/executor.py
index 57042a8690..1a79f6d79f 100644
--- a/django/db/migrations/executor.py
+++ b/django/db/migrations/executor.py
@@ -44,12 +44,20 @@ class MigrationExecutor:
                 # may roll back dependencies in other apps that don't need to
                 # be rolled back); instead roll back through target's immediate
                 # child(ren) in the same app, and no further.
-                next_in_app = sorted(
-                    n for n in
-                    self.loader.graph.node_map[target].children
-                    if n[0] == target[0]
-                )
-                for node in next_in_app:
+                # If the target migration is not in the graph, it might have
+                # been replaced by a squashed migration. Target the leaf nodes.
+                if target not in self.loader.graph.node_map:
+                    nodes_to_check = self.loader.graph.leaf_nodes(target[0])
+                else:
+                    # Target the target node's immediate children in the same app
+                    # to avoid rolling back dependencies in other apps.
+                    nodes_to_check = sorted(
+                        n for n in
+                        self.loader.graph.node_map[target].children
+                        if n[0] == target[0]
+                    )
+                # Roll back from each target node.
+                for node in nodes_to_check:
                     for migration in self.loader.graph.backwards_plan(node):
                         if migration in applied:
                             plan.append((self.loader.graph.nodes[migration], True))
